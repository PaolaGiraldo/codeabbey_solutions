#|$ sblint -v paolagiraldo.lsp
[INFO] Lint file paolagiraldo.lsp

$ clisp -c paolagiraldo.lsp
Compiling file /home/../paolagiraldo.lsp ...
Wrote file /home/../paolagiraldo.fas
0 errors, 0 warnings
Bye.
|#

(defun read-data (&optional (read-line))
  (declare (ignore read-line))
  (let (*read-eval*)
    (loop :for line = (read-line nil nil)
    :while line
    :collect (read-from-string (concatenate 'string "("
      (write-to-string line) ")" )))))


(defun number-to-list (n)    
  (loop for c across (write-to-string n) collect (digit-char-p c)))

(defun make-index (pos length)
  (loop :for n :from pos :below length :by (* (1+ pos) 2)
    :collect n))


(defun add-parity-bits (numList)
  (let ((new ()) (i 1) (numList))
    (loop while numList do
      (if (integerp (log i 2))
        (setq new (append new '(_)))
        (progn
          (setq new (append new (list (first numList))))
          (setq numList (cdr numList))))
          (setq i (1+ i)))
    (block nil
      (return new))))

(defun calc-bit (parity)
  (let ((bit) (list) (index) (end))
    (dotimes (pos (length parity))
      (if (integerp (log (1+ pos) 2))
        (progn
          (setq index (make-index pos (length parity)))
            (setq list ())
            (dolist (ind index)
              (setq end (+ ind (1+ pos)))
              (if (< end (length parity))
                (setq list (append list (subseq parity ind end )))
                (setq list (append list (subseq parity ind)))))

          (if (evenp (count 1 list))
            (setf (nth pos parity) 0)
            (setf (nth pos parity) 1)))))
    ;;(format nil "狺疳蜷豉ㄢ祜汶铋蝈趱蝾疳蜷豉┅┅ㄤ彐躅孱泔溴祗舂戾è疳蜷豉铛硖轶舂ㄤ镬轶铛祗舂箦赳铛硖轶ㄤ屐弭铋铛礅弪麸扉篝ㄦ轵篝铛愆┅箦赳疳蜷豉ㄡ滗疳蜷豉忾趔铛硖轶舂ㄣ犰悱忾疳蜷豉┅┅ㄤ彐躅汨邈祗舂换痱轭祗舂戾è铛硖轶舂疳蜷豉┅ㄤ镬轶铛祗舂箦赳铛硖轶ㄤ屐弭铋铛礅弪麸扉篝ㄦ轵篝铛愆┅换痱轭疳蝮瀛轭翦珏ㄦ轵篝铛愆候徜轼卑┅痱轭铛硖轶舂箦赳狨ㄣ镳扉篝铛硖轶舂换ㄦ矧磲窿铛硖轶舂箦赳疳蜷豉ㄣ犰悱忾铛硖轶舂痱轭疳蜷豉换痱轭Л痱轭狨ㄤ雉轫弩ㄩ戾铉翳铛硖轶舂换痱轭椹换痱轭铛硖轶舂换痱轭疳蜷豉换痱轭铘狨┅换痱轭铘疳蜷豉┅ㄩ铘狨铘疳蜷豉痱轭癌痱轭暴┅痱轭Л换痱轭狨┅ㄤ彐躅栳眄轭绛泔溴ㄤ狒岍戾è铛砼钽镤濠麸蓬泔溴麸描邈氅箦赳铛砼钽镤疳蝮瀛轭翦珏ㄣ後溽翎┅箦赳麸蓬泔溴篚怏羼ㄣ潋溽翎铛砼钽镤濠箦赳麸描邈篚怏羼溽翎ǐ铛砼钽镤博┅换ㄥ钽镤麸蓬泔溴ㄣ桢汶麸描邈氅┅ㄤ彐鲠溽翎箦赳溽翎蝈徜溽翎┅ㄨ犴黹铉泔溴溽翎｜汜牧粤祗沆轶疳镬徵轵犰滹祗